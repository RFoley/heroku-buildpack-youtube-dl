#!/bin/sh

echo "youtube-dl requires Python - please ensure it is installed before use."
echo "Installing youtube-dl..."

BUILD_DIR=$1
VENDOR_DIR="vendor"

DOWNLOAD_URL="https://yt-dl.org/downloads/latest/youtube-dl"

echo "Creating install dir $VENDOR_DIR\youtube-dl..."
cd $BUILD_DIR
mkdir -p $VENDOR_DIR\youtube-dl
cd $VENDOR_DIR\youtube-dl

echo "Downloading from $DOWNLOAD_URL..."
curl -L --silent $DOWNLOAD_URL -o youtube-dl
chmod a+rx youtube-dl

echo "Exporting PATH..."
PROFILE_PATH="$BUILD_DIR/.profile.d/youtube-dl.sh"
mkdir -p $(dirname $PROFILE_PATH)
echo 'export PATH="$PATH:${HOME}/vendor/youtube-dl"' >> $PROFILE_PATH